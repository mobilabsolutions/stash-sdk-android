package com.mobilabsolutions.payment.android.psdk.exceptions.base

import com.google.gson.Gson
import com.google.gson.GsonBuilder
import com.mobilabsolutions.payment.android.psdk.internal.ThrowableSerializer
import org.junit.Assert.assertNotNull
import org.junit.Assert.assertTrue
import org.junit.Test

class PaymentExceptionTest {
    companion object {
        val gson: Gson = GsonBuilder()
            .registerTypeHierarchyAdapter(Throwable::class.java, ThrowableSerializer())
            .create()
    }

    @Test
    fun testSerializingAnException() {
        val anException = RuntimeException("Just an Exception")

        assertTrue(
            gson.toJson(anException.stackTrace).length > 20)
    }

    @Test
    fun testSerializingARealException() {
        try {
            val a = 10 / 0
        } catch (e: Exception) {
            assertTrue(
                gson.toJson(e.stackTrace).length > 20)
        }
    }

    @Test
    fun testSerializingARealExceptionWithCause() {
        try {
            val a = 10 / 0
        } catch (e: Exception) {
            // Prepare
            e.initCause(Exception("Noting"))

            // Test
            assertTrue(
                gson.toJson(e.stackTrace).length > 20)

            assertTrue(
                gson.toJson(e.cause?.stackTrace).length > 20)
        }
    }

    @Test
    fun testSerializingARealExceptionWithNestedCauses() {
        try {
            val a = 10 / 0
        } catch (e: Exception) {
            // Prepare
            e.initCause(Exception("One"))
            var t = e.cause
            t?.initCause(Exception("Two"))
            t = t?.cause
            t?.initCause(Exception("Three"))
            t = t?.cause
            t?.initCause(Exception("Four"))
            t = t?.cause
            t?.initCause(Exception("Five"))
            t = t?.cause
            t?.initCause(Exception("Six"))
            t = t?.cause
            t?.initCause(Exception("Seven"))

            // Test
            // Test
            assertTrue(
                gson.toJson(e.stackTrace).length > 20)

            assertTrue(
                gson.toJson(e.cause?.stackTrace).length > 20)

            assertTrue(
                gson.toJson(e.cause?.cause?.stackTrace).length > 20)

            assertTrue(
                gson.toJson(e.cause?.cause?.cause?.stackTrace).length > 20)

            assertTrue(
                gson.toJson(e.cause?.cause?.cause?.stackTrace).length > 20)
        }
    }

    @Test
    fun testDeserializingARealExceptionWithNestedCauses() {
        val json = "{\"detailMessage\":\"/ by zero\",\"cause\":{\"detailMessage\":\"One\",\"cause\":{\"detailMessage\":\"Two\",\"cause\":{\"detailMessage\":\"Three\",\"cause\":{\"detailMessage\":\"Four\",\"cause\":{\"detailMessage\":\"Five\",\"cause\":{\"detailMessage\":\"Six\",\"cause\":{\"detailMessage\":\"Seven\",\"stackTrace\":[{\"declaringClass\":\"com.mobilabsolutions.payment.android.psdk.exceptions.base.PaymentExceptionTest\",\"methodName\":\"testSerializingARealExceptionWithNestedCauses\",\"fileName\":\"PaymentExceptionTest.kt\",\"lineNumber\":72},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke0\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62},{\"declaringClass\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43},{\"declaringClass\":\"java.lang.reflect.Method\",\"methodName\":\"invoke\",\"fileName\":\"Method.java\",\"lineNumber\":498},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\$1\",\"methodName\":\"runReflectiveCall\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":50},{\"declaringClass\":\"org.junit.internal.runners.model.ReflectiveCallable\",\"methodName\":\"run\",\"fileName\":\"ReflectiveCallable.java\",\"lineNumber\":12},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\",\"methodName\":\"invokeExplosively\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":47},{\"declaringClass\":\"org.junit.internal.runners.statements.InvokeMethod\",\"methodName\":\"evaluate\",\"fileName\":\"InvokeMethod.java\",\"lineNumber\":17},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runLeaf\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":325},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":78},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":57},{\"declaringClass\":\"org.junit.runners.ParentRunner\$3\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":290},{\"declaringClass\":\"org.junit.runners.ParentRunner\$1\",\"methodName\":\"schedule\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":71},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runChildren\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":288},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"access\$000\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":58},{\"declaringClass\":\"org.junit.runners.ParentRunner\$2\",\"methodName\":\"evaluate\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":268},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":363},{\"declaringClass\":\"org.junit.runner.JUnitCore\",\"methodName\":\"run\",\"fileName\":\"JUnitCore.java\",\"lineNumber\":137},{\"declaringClass\":\"com.intellij.junit4.JUnit4IdeaTestRunner\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"JUnit4IdeaTestRunner.java\",\"lineNumber\":68},{\"declaringClass\":\"com.intellij.rt.execution.junit.IdeaTestRunner\$Repeater\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"IdeaTestRunner.java\",\"lineNumber\":47},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"prepareStreamsAndStart\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":242},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"main\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":70}],\"suppressedExceptions\":[]},\"stackTrace\":[{\"declaringClass\":\"com.mobilabsolutions.payment.android.psdk.exceptions.base.PaymentExceptionTest\",\"methodName\":\"testSerializingARealExceptionWithNestedCauses\",\"fileName\":\"PaymentExceptionTest.kt\",\"lineNumber\":70},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke0\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62},{\"declaringClass\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43},{\"declaringClass\":\"java.lang.reflect.Method\",\"methodName\":\"invoke\",\"fileName\":\"Method.java\",\"lineNumber\":498},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\$1\",\"methodName\":\"runReflectiveCall\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":50},{\"declaringClass\":\"org.junit.internal.runners.model.ReflectiveCallable\",\"methodName\":\"run\",\"fileName\":\"ReflectiveCallable.java\",\"lineNumber\":12},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\",\"methodName\":\"invokeExplosively\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":47},{\"declaringClass\":\"org.junit.internal.runners.statements.InvokeMethod\",\"methodName\":\"evaluate\",\"fileName\":\"InvokeMethod.java\",\"lineNumber\":17},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runLeaf\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":325},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":78},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":57},{\"declaringClass\":\"org.junit.runners.ParentRunner\$3\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":290},{\"declaringClass\":\"org.junit.runners.ParentRunner\$1\",\"methodName\":\"schedule\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":71},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runChildren\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":288},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"access\$000\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":58},{\"declaringClass\":\"org.junit.runners.ParentRunner\$2\",\"methodName\":\"evaluate\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":268},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":363},{\"declaringClass\":\"org.junit.runner.JUnitCore\",\"methodName\":\"run\",\"fileName\":\"JUnitCore.java\",\"lineNumber\":137},{\"declaringClass\":\"com.intellij.junit4.JUnit4IdeaTestRunner\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"JUnit4IdeaTestRunner.java\",\"lineNumber\":68},{\"declaringClass\":\"com.intellij.rt.execution.junit.IdeaTestRunner\$Repeater\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"IdeaTestRunner.java\",\"lineNumber\":47},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"prepareStreamsAndStart\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":242},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"main\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":70}],\"suppressedExceptions\":[]},\"stackTrace\":[{\"declaringClass\":\"com.mobilabsolutions.payment.android.psdk.exceptions.base.PaymentExceptionTest\",\"methodName\":\"testSerializingARealExceptionWithNestedCauses\",\"fileName\":\"PaymentExceptionTest.kt\",\"lineNumber\":68},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke0\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62},{\"declaringClass\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43},{\"declaringClass\":\"java.lang.reflect.Method\",\"methodName\":\"invoke\",\"fileName\":\"Method.java\",\"lineNumber\":498},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\$1\",\"methodName\":\"runReflectiveCall\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":50},{\"declaringClass\":\"org.junit.internal.runners.model.ReflectiveCallable\",\"methodName\":\"run\",\"fileName\":\"ReflectiveCallable.java\",\"lineNumber\":12},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\",\"methodName\":\"invokeExplosively\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":47},{\"declaringClass\":\"org.junit.internal.runners.statements.InvokeMethod\",\"methodName\":\"evaluate\",\"fileName\":\"InvokeMethod.java\",\"lineNumber\":17},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runLeaf\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":325},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":78},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":57},{\"declaringClass\":\"org.junit.runners.ParentRunner\$3\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":290},{\"declaringClass\":\"org.junit.runners.ParentRunner\$1\",\"methodName\":\"schedule\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":71},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runChildren\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":288},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"access\$000\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":58},{\"declaringClass\":\"org.junit.runners.ParentRunner\$2\",\"methodName\":\"evaluate\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":268},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":363},{\"declaringClass\":\"org.junit.runner.JUnitCore\",\"methodName\":\"run\",\"fileName\":\"JUnitCore.java\",\"lineNumber\":137},{\"declaringClass\":\"com.intellij.junit4.JUnit4IdeaTestRunner\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"JUnit4IdeaTestRunner.java\",\"lineNumber\":68},{\"declaringClass\":\"com.intellij.rt.execution.junit.IdeaTestRunner\$Repeater\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"IdeaTestRunner.java\",\"lineNumber\":47},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"prepareStreamsAndStart\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":242},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"main\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":70}],\"suppressedExceptions\":[]},\"stackTrace\":[{\"declaringClass\":\"com.mobilabsolutions.payment.android.psdk.exceptions.base.PaymentExceptionTest\",\"methodName\":\"testSerializingARealExceptionWithNestedCauses\",\"fileName\":\"PaymentExceptionTest.kt\",\"lineNumber\":66},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke0\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62},{\"declaringClass\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43},{\"declaringClass\":\"java.lang.reflect.Method\",\"methodName\":\"invoke\",\"fileName\":\"Method.java\",\"lineNumber\":498},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\$1\",\"methodName\":\"runReflectiveCall\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":50},{\"declaringClass\":\"org.junit.internal.runners.model.ReflectiveCallable\",\"methodName\":\"run\",\"fileName\":\"ReflectiveCallable.java\",\"lineNumber\":12},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\",\"methodName\":\"invokeExplosively\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":47},{\"declaringClass\":\"org.junit.internal.runners.statements.InvokeMethod\",\"methodName\":\"evaluate\",\"fileName\":\"InvokeMethod.java\",\"lineNumber\":17},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runLeaf\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":325},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":78},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":57},{\"declaringClass\":\"org.junit.runners.ParentRunner\$3\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":290},{\"declaringClass\":\"org.junit.runners.ParentRunner\$1\",\"methodName\":\"schedule\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":71},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runChildren\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":288},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"access\$000\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":58},{\"declaringClass\":\"org.junit.runners.ParentRunner\$2\",\"methodName\":\"evaluate\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":268},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":363},{\"declaringClass\":\"org.junit.runner.JUnitCore\",\"methodName\":\"run\",\"fileName\":\"JUnitCore.java\",\"lineNumber\":137},{\"declaringClass\":\"com.intellij.junit4.JUnit4IdeaTestRunner\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"JUnit4IdeaTestRunner.java\",\"lineNumber\":68},{\"declaringClass\":\"com.intellij.rt.execution.junit.IdeaTestRunner\$Repeater\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"IdeaTestRunner.java\",\"lineNumber\":47},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"prepareStreamsAndStart\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":242},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"main\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":70}],\"suppressedExceptions\":[]},\"stackTrace\":[{\"declaringClass\":\"com.mobilabsolutions.payment.android.psdk.exceptions.base.PaymentExceptionTest\",\"methodName\":\"testSerializingARealExceptionWithNestedCauses\",\"fileName\":\"PaymentExceptionTest.kt\",\"lineNumber\":64},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke0\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62},{\"declaringClass\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43},{\"declaringClass\":\"java.lang.reflect.Method\",\"methodName\":\"invoke\",\"fileName\":\"Method.java\",\"lineNumber\":498},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\$1\",\"methodName\":\"runReflectiveCall\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":50},{\"declaringClass\":\"org.junit.internal.runners.model.ReflectiveCallable\",\"methodName\":\"run\",\"fileName\":\"ReflectiveCallable.java\",\"lineNumber\":12},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\",\"methodName\":\"invokeExplosively\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":47},{\"declaringClass\":\"org.junit.internal.runners.statements.InvokeMethod\",\"methodName\":\"evaluate\",\"fileName\":\"InvokeMethod.java\",\"lineNumber\":17},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runLeaf\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":325},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":78},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":57},{\"declaringClass\":\"org.junit.runners.ParentRunner\$3\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":290},{\"declaringClass\":\"org.junit.runners.ParentRunner\$1\",\"methodName\":\"schedule\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":71},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runChildren\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":288},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"access\$000\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":58},{\"declaringClass\":\"org.junit.runners.ParentRunner\$2\",\"methodName\":\"evaluate\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":268},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":363},{\"declaringClass\":\"org.junit.runner.JUnitCore\",\"methodName\":\"run\",\"fileName\":\"JUnitCore.java\",\"lineNumber\":137},{\"declaringClass\":\"com.intellij.junit4.JUnit4IdeaTestRunner\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"JUnit4IdeaTestRunner.java\",\"lineNumber\":68},{\"declaringClass\":\"com.intellij.rt.execution.junit.IdeaTestRunner\$Repeater\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"IdeaTestRunner.java\",\"lineNumber\":47},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"prepareStreamsAndStart\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":242},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"main\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":70}],\"suppressedExceptions\":[]},\"stackTrace\":[{\"declaringClass\":\"com.mobilabsolutions.payment.android.psdk.exceptions.base.PaymentExceptionTest\",\"methodName\":\"testSerializingARealExceptionWithNestedCauses\",\"fileName\":\"PaymentExceptionTest.kt\",\"lineNumber\":62},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke0\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62},{\"declaringClass\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43},{\"declaringClass\":\"java.lang.reflect.Method\",\"methodName\":\"invoke\",\"fileName\":\"Method.java\",\"lineNumber\":498},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\$1\",\"methodName\":\"runReflectiveCall\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":50},{\"declaringClass\":\"org.junit.internal.runners.model.ReflectiveCallable\",\"methodName\":\"run\",\"fileName\":\"ReflectiveCallable.java\",\"lineNumber\":12},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\",\"methodName\":\"invokeExplosively\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":47},{\"declaringClass\":\"org.junit.internal.runners.statements.InvokeMethod\",\"methodName\":\"evaluate\",\"fileName\":\"InvokeMethod.java\",\"lineNumber\":17},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runLeaf\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":325},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":78},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":57},{\"declaringClass\":\"org.junit.runners.ParentRunner\$3\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":290},{\"declaringClass\":\"org.junit.runners.ParentRunner\$1\",\"methodName\":\"schedule\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":71},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runChildren\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":288},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"access\$000\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":58},{\"declaringClass\":\"org.junit.runners.ParentRunner\$2\",\"methodName\":\"evaluate\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":268},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":363},{\"declaringClass\":\"org.junit.runner.JUnitCore\",\"methodName\":\"run\",\"fileName\":\"JUnitCore.java\",\"lineNumber\":137},{\"declaringClass\":\"com.intellij.junit4.JUnit4IdeaTestRunner\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"JUnit4IdeaTestRunner.java\",\"lineNumber\":68},{\"declaringClass\":\"com.intellij.rt.execution.junit.IdeaTestRunner\$Repeater\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"IdeaTestRunner.java\",\"lineNumber\":47},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"prepareStreamsAndStart\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":242},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"main\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":70}],\"suppressedExceptions\":[]},\"stackTrace\":[{\"declaringClass\":\"com.mobilabsolutions.payment.android.psdk.exceptions.base.PaymentExceptionTest\",\"methodName\":\"testSerializingARealExceptionWithNestedCauses\",\"fileName\":\"PaymentExceptionTest.kt\",\"lineNumber\":60},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke0\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62},{\"declaringClass\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43},{\"declaringClass\":\"java.lang.reflect.Method\",\"methodName\":\"invoke\",\"fileName\":\"Method.java\",\"lineNumber\":498},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\$1\",\"methodName\":\"runReflectiveCall\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":50},{\"declaringClass\":\"org.junit.internal.runners.model.ReflectiveCallable\",\"methodName\":\"run\",\"fileName\":\"ReflectiveCallable.java\",\"lineNumber\":12},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\",\"methodName\":\"invokeExplosively\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":47},{\"declaringClass\":\"org.junit.internal.runners.statements.InvokeMethod\",\"methodName\":\"evaluate\",\"fileName\":\"InvokeMethod.java\",\"lineNumber\":17},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runLeaf\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":325},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":78},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":57},{\"declaringClass\":\"org.junit.runners.ParentRunner\$3\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":290},{\"declaringClass\":\"org.junit.runners.ParentRunner\$1\",\"methodName\":\"schedule\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":71},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runChildren\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":288},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"access\$000\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":58},{\"declaringClass\":\"org.junit.runners.ParentRunner\$2\",\"methodName\":\"evaluate\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":268},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":363},{\"declaringClass\":\"org.junit.runner.JUnitCore\",\"methodName\":\"run\",\"fileName\":\"JUnitCore.java\",\"lineNumber\":137},{\"declaringClass\":\"com.intellij.junit4.JUnit4IdeaTestRunner\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"JUnit4IdeaTestRunner.java\",\"lineNumber\":68},{\"declaringClass\":\"com.intellij.rt.execution.junit.IdeaTestRunner\$Repeater\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"IdeaTestRunner.java\",\"lineNumber\":47},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"prepareStreamsAndStart\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":242},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"main\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":70}],\"suppressedExceptions\":[]},\"stackTrace\":[{\"declaringClass\":\"com.mobilabsolutions.payment.android.psdk.exceptions.base.PaymentExceptionTest\",\"methodName\":\"testSerializingARealExceptionWithNestedCauses\",\"fileName\":\"PaymentExceptionTest.kt\",\"lineNumber\":57},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke0\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":-2},{\"declaringClass\":\"sun.reflect.NativeMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"NativeMethodAccessorImpl.java\",\"lineNumber\":62},{\"declaringClass\":\"sun.reflect.DelegatingMethodAccessorImpl\",\"methodName\":\"invoke\",\"fileName\":\"DelegatingMethodAccessorImpl.java\",\"lineNumber\":43},{\"declaringClass\":\"java.lang.reflect.Method\",\"methodName\":\"invoke\",\"fileName\":\"Method.java\",\"lineNumber\":498},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\$1\",\"methodName\":\"runReflectiveCall\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":50},{\"declaringClass\":\"org.junit.internal.runners.model.ReflectiveCallable\",\"methodName\":\"run\",\"fileName\":\"ReflectiveCallable.java\",\"lineNumber\":12},{\"declaringClass\":\"org.junit.runners.model.FrameworkMethod\",\"methodName\":\"invokeExplosively\",\"fileName\":\"FrameworkMethod.java\",\"lineNumber\":47},{\"declaringClass\":\"org.junit.internal.runners.statements.InvokeMethod\",\"methodName\":\"evaluate\",\"fileName\":\"InvokeMethod.java\",\"lineNumber\":17},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runLeaf\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":325},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":78},{\"declaringClass\":\"org.junit.runners.BlockJUnit4ClassRunner\",\"methodName\":\"runChild\",\"fileName\":\"BlockJUnit4ClassRunner.java\",\"lineNumber\":57},{\"declaringClass\":\"org.junit.runners.ParentRunner\$3\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":290},{\"declaringClass\":\"org.junit.runners.ParentRunner\$1\",\"methodName\":\"schedule\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":71},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"runChildren\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":288},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"access\$000\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":58},{\"declaringClass\":\"org.junit.runners.ParentRunner\$2\",\"methodName\":\"evaluate\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":268},{\"declaringClass\":\"org.junit.runners.ParentRunner\",\"methodName\":\"run\",\"fileName\":\"ParentRunner.java\",\"lineNumber\":363},{\"declaringClass\":\"org.junit.runner.JUnitCore\",\"methodName\":\"run\",\"fileName\":\"JUnitCore.java\",\"lineNumber\":137},{\"declaringClass\":\"com.intellij.junit4.JUnit4IdeaTestRunner\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"JUnit4IdeaTestRunner.java\",\"lineNumber\":68},{\"declaringClass\":\"com.intellij.rt.execution.junit.IdeaTestRunner\$Repeater\",\"methodName\":\"startRunnerWithArgs\",\"fileName\":\"IdeaTestRunner.java\",\"lineNumber\":47},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"prepareStreamsAndStart\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":242},{\"declaringClass\":\"com.intellij.rt.execution.junit.JUnitStarter\",\"methodName\":\"main\",\"fileName\":\"JUnitStarter.java\",\"lineNumber\":70}],\"suppressedExceptions\":[]}"
        val t = gson.fromJson(json, Throwable::class.java)

        assertNotNull(t)
        t.printStackTrace()
    }
}